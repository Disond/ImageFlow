<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="de">
<head>
<title>ImageFlow 0.3</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" />
<meta name="language" content="de" />
<meta name="description" content="ImageFlow ist eine Bildergallerie in Javascript, angelehnt an Apples CoverFlow."/>
<meta name="keywords" content="ImageFlow, image flow, CoverFlow, cover flow, Javascript, imageflow in javascript, coverflow in javascript" />
<meta name="robots" content="index, follow, noarchive" />
<link rel="shortcut icon" href="favicon.ico" type="image/ico" />
<style type="text/css">
body {
	background-color:#000;
	text-align:center;
	color: #fff;
	margin: 0;
	padding: 0;
	font-size:100.1%;
	font: 83%/1.4 verdana, arial, helvetica, sans-serif;
}
img { 
	position:absolute; 
	top:0px; 
}
h1 {
	text-align:center;
}
a{
	color:#fff;
}
#captionTarget{
	position:absolute;
	margin-top:50px;
	text-align:center;
}
#imageflow{
	margin-left:350px;
	text-align:left;
}
#changelog{
	width:349px;
	border-right:solid 1px #666;
	float:left;
	margin-top:15px
}
#changelog div{
	padding:15px;
	text-align:left;
}
</style>
<script language="JavaScript" type="text/javascript">
<!--
/*
 *	ImageFlow 0.3
 *
 *	This code is based on Michael L. Perrys Cover flow in Javascript.
 *	For he wrote that "You can take this code and use it as your own" [1]
 *	this is my attempt to improve some things. Feel free to use it! If
 *	you have any questions on it leave a message in my shoutbox [2].
 *
 *	The reflection is generated server-sided by a slightly hacked  
 *	version of Richard Daveys easyreflections [3] written in PHP.
 *
 *
 *	[1] http://www.adventuresinsoftware.com/blog/?p=104#comment-1981
 *	[2] http://shoutbox.finnrudolph.de/
 *	[3] http://reflection.corephp.co.uk/v2.php
 *	
 */

/* Define some variables */
var current = 0;
var target = 0;
var timer = 0;
var captionId = "i1";
var captionTarget = "";
var img_h = 0;
var img_w = 0;
var img_percent = 0;
var z = 0;
var xs = 0;
var image = 0;
var new_img_h = 0;
var new_img_top = 0;

/* This variable must be changed to the used reflection image height in % of the source image */
var reflection_p = 0.5;

/* Get width of the images div container */
function windowWidth()
{
	var width = document.getElementById("images").offsetWidth;
	return width;
}

function step()
{
	if (target < current-1 || target > current+1)
	{
		moveTo(current + (target-current)/3);
		window.setTimeout(step, 50);
		timer = 1;
	}
	else
	{
		timer = 0;
	}
}

function glideTo(x, newCaptionId)
{
	target = x;
	if (timer == 0)
	{
		window.setTimeout(step, 50);
		timer = 1;
	}

	captionId = newCaptionId;
	var caption = document.getElementById(captionId);
	captionTarget.innerHTML = caption.innerHTML;
}


function moveTo(x)
{
	current = x;

	/* do stuff with the images div */
	var padding_left = document.getElementById("imageflow").offsetLeft;
	var div = document.getElementById("images");
	var top = div.offsetTop;
	var width = windowWidth();
	var size = width * 0.5;
	var max = div.childNodes.length;
	var zIndex = max;

	for (index = 0; index < max; index++)
	{
		image = div.childNodes.item(index);
		if (image.nodeType == 1)
		{
			z = Math.sqrt(10000 + x * x)+100;
			xs = x / z * size + size;
			
			/* Get current image properties */
			img_h = image.height;
			img_w = image.width;
			
			/* Check source image format. Get image height minus reflection height! */
			switch ((img_w + 1) > (img_h / (reflection_p + 1))) 
			{
				/* Landscape format */
				case true:
					img_percent = 118;
					break;

				/* Portrait and square format */
				default:
					img_percent = 100;
					break;
			}
			
			/* Process new image height and top spacing */
			new_img_h = (img_h / img_w * img_percent) / z * size;
			new_img_top = (width * 0.35 - new_img_h) + top + ((new_img_h / (reflection_p + 1)) * reflection_p);

			/* Set new image properties */
			image.style.left = xs - (img_percent / 2) / z * size + padding_left + "px";
			image.style.height = new_img_h + "px";
			image.style.width= "";
			image.style.top = new_img_top + "px";
			image.style.zIndex = zIndex;

			if ( x < 0 )
			{
				zIndex++;
			}
			else
			{
				zIndex = zIndex -1;
			}
			x += 150;
		}
	}
}

/* Main Function */
function refresh()
{
	var width = windowWidth();
	var height = width * 0.35;
	var images = document.getElementById("images");
	images.style.height = height + "px";

	/* Text on top through zIndex */
	captionTarget = document.getElementById("captionTarget");
	captionTarget.style.top = images.offsetTop + height + "px";
	captionTarget.style.width = width + "px";
	captionTarget.style.zIndex = 10000;
	var caption = document.getElementById(captionId);
	captionTarget.innerHTML = caption.innerHTML;
	
	/* Call subFunction */
	moveTo(current);
}
//-->
</script> 
</head>
<body onload="refresh();">
<div style="width:100%">

<div id="changelog">
	<b>ChangeLog</b><br/>
	<div>
		Version 0.3
		<ul>
			<li>Added server side generated reflections</li>
			<li>Minor performance improvements</li>
			<li>Fixed correct scaling of square formats</li>
		</ul>
		<br/>
		Version 0.2
		<ul>
			<li>Changed global scaling and positioning: now it scales in relation to the div container "images"</li>
		</ul>
		<br/>
		Version 0.1
		<ul>
			<li>Improved browser compatibility</li>
			<li>Added bottom alignment </li>
			<li>Added correct scaling of different image formats</li>
		</ul>
		<br/>
		<b>Download:</b> <a href="ImageFlow_v0.3.rar">ImageFlow_v0.3.rar</a> [10 KB]<br/> 
		<br/><br/>
		You are free to use this in any product, or on any web site. For more information on ImageFlow check my <a target="_top" href="http://194.95.111.244/~countzero/myCMS/index.php?c_id=1&amp;s_id=4&amp;tag=ImageFlow">Newsblog</a>. For anything else simply drop a line in my <a href="http://shoutbox.finnrudolph.de/">Shoutbox</a>.<br/>
	</div>
</div>

<div id="imageflow">
	<h1>ImageFlow 0.3</h1><br/>
	<div id="images">
		<img onclick="glideTo(    0,  'i1' )" src="reflect.php?img=img/img001.jpg" alt="" />
		<img onclick="glideTo( -150,  'i2' )" src="reflect.php?img=img/img002.jpg" alt="" />
		<img onclick="glideTo( -300,  'i3' )" src="reflect.php?img=img/img003.jpg" alt="" />
		<img onclick="glideTo( -450,  'i4' )" src="reflect.php?img=img/img004.jpg" alt="" />
		<img onclick="glideTo( -600,  'i5' )" src="reflect.php?img=img/img005.jpg" alt="" />
		<img onclick="glideTo( -750,  'i6' )" src="reflect.php?img=img/img006.jpg" alt="" />
		<img onclick="glideTo( -900,  'i7' )" src="reflect.php?img=img/img002.jpg" alt="" />
		<img onclick="glideTo( -1050, 'i8' )" src="reflect.php?img=img/img004.jpg" alt="" />
		<img onclick="glideTo( -1200, 'i9' )" src="reflect.php?img=img/img005.jpg" alt="" />
		<img onclick="glideTo( -1350, 'i10')" src="reflect.php?img=img/img004.jpg" alt="" />

	</div>

	<div id="captionTarget"></div>

	<div style="display:none;">
		<div id="i1"><b>Image 1</b></div>
		<div id="i2"><b>Image 2</b></div>
		<div id="i3"><b>Image 3</b></div>
		<div id="i4"><b>Image 4</b></div>
		<div id="i5"><b>Image 5</b></div>
		<div id="i6"><b>Image 6</b></div>
		<div id="i7"><b>Image 7</b></div>
		<div id="i8"><b>Image 8</b></div>
		<div id="i9"><b>Image 9</b></div>
		<div id="i10"><b>Image 10</b></div>
	</div>

</div>
<div style="clear:both;"></div>
</div>

<script language="JavaScript" type="text/javascript">
<!--
window.onresize = function() { refresh(); }
refresh();
//-->
</script> 

<!-- The following javascript is Google Analytics trackingcode and has nothing to do with ImageFlow -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-1076251-6";
urchinTracker();
</script>
</body>
</html>